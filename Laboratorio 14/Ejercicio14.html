<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Herencia: Usuario, Cliente y Administrador</title>
</head>
<body>
  <h2>Gestión de Usuarios (POO / Herencia)</h2>

  <label for="tipoUsuario">Tipo de usuario:</label>
  <select id="tipoUsuario" onchange="actualizarFormulario()">
    <option value="cliente">Cliente</option>
    <option value="admin">Administrador</option>
  </select>

  <h3>Datos básicos</h3>
  <label for="nombre">Nombre:</label>
  <input type="text" id="nombre" placeholder="Ej: Juan Pérez">

  <label for="email">Email:</label>
  <input type="email" id="email" placeholder="Ej: juan@example.com">

  <!-- Datos extra para Cliente -->
  <div id="formCliente">
    <h3>Datos de Cliente</h3>
    <label for="nivelFidelidad">Nivel de fidelidad (1–5):</label>
    <input type="number" id="nivelFidelidad" min="1" max="5" value="3">
  </div>

  <!-- Datos extra para Administrador -->
  <div id="formAdmin" style="display:none;">
    <h3>Permisos de Administrador</h3>
    <label>
      <input type="checkbox" id="permCrear" checked>
      Crear
    </label>
    <label>
      <input type="checkbox" id="permEditar" checked>
      Editar
    </label>
    <label>
      <input type="checkbox" id="permEliminar">
      Eliminar
    </label>
  </div>

  <br>
  <button onclick="crearUsuario()">Crear usuario</button>

  <p id="mensaje" style="color:red;"></p>

  <h3>Usuarios creados</h3>
  <ul id="listaUsuarios"></ul>

  <script>
    // ======== Clases (POO + Herencia) ========
    class Usuario {
      constructor(nombre, email) {
        this.nombre = nombre;
        this.email = email;
      }

      mostrarInfo() {
        return `Nombre: ${this.nombre}, Email: ${this.email}`;
      }
    }

    class Cliente extends Usuario {
      constructor(nombre, email, nivelFidelidad) {
        super(nombre, email); // reutiliza constructor base
        this.nivelFidelidad = nivelFidelidad; // 1–5
      }

      mostrarInfo() {
        return `${super.mostrarInfo()}, Nivel de fidelidad: ${this.nivelFidelidad}`;
      }
    }

    class Administrador extends Usuario {
      constructor(nombre, email, permisos) {
        super(nombre, email);
        this.permisos = permisos; // { crear, editar, eliminar }
      }

      mostrarInfo() {
        const { crear, editar, eliminar } = this.permisos;
        return (
          `${super.mostrarInfo()}, ` +
          `Permisos -> crear: ${crear}, editar: ${editar}, eliminar: ${eliminar}`
        );
      }
    }

    // Lista en memoria (solo demo)
    const usuarios = [];

    // ======== Lógica de UI ========
    function actualizarFormulario() {
      const tipo = document.getElementById('tipoUsuario').value;
      const formCliente = document.getElementById('formCliente');
      const formAdmin = document.getElementById('formAdmin');

      if (tipo === 'cliente') {
        formCliente.style.display = 'block';
        formAdmin.style.display = 'none';
      } else {
        formCliente.style.display = 'none';
        formAdmin.style.display = 'block';
      }

      document.getElementById('mensaje').textContent = '';
    }

    function crearUsuario() {
      const tipo = document.getElementById('tipoUsuario').value;
      const nombre = document.getElementById('nombre').value.trim();
      const email = document.getElementById('email').value.trim();
      const msg = document.getElementById('mensaje');
      msg.textContent = '';

      if (!nombre || !email) {
        msg.textContent = 'Nombre y email son obligatorios.';
        return;
      }

      let usuario;

      if (tipo === 'cliente') {
        const nivel = parseInt(document.getElementById('nivelFidelidad').value);

        if (isNaN(nivel) || nivel < 1 || nivel > 5) {
          msg.textContent = 'El nivel de fidelidad debe estar entre 1 y 5.';
          return;
        }

        usuario = new Cliente(nombre, email, nivel);

      } else {
        const permisos = {
          crear: document.getElementById('permCrear').checked,
          editar: document.getElementById('permEditar').checked,
          eliminar: document.getElementById('permEliminar').checked
        };

        usuario = new Administrador(nombre, email, permisos);
      }

      usuarios.push(usuario);
      renderUsuarios();
      msg.textContent = 'Usuario creado correctamente.';
    }

    function renderUsuarios() {
      const ul = document.getElementById('listaUsuarios');
      ul.innerHTML = '';

      usuarios.forEach((u, idx) => {
        const li = document.createElement('li');
        li.textContent = `#${idx + 1} - ${u.mostrarInfo()}`;
        ul.appendChild(li);
      });
    }
  </script>
</body>
</html>
